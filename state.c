#include "state.h"
#include <string.h>
#include <stdio.h>

void init_chip(state_ *state){
    state->sp = 0;
    state->st = 0;
    state->dt = 0;
    state->pc = 0x200;

    memset(state->V, 0, sizeof(state->V));
    memset(state->stack, 0, sizeof(state->stack));
    memset(state->keypad, 0, sizeof(state->keypad));
    memset(state->display, 0, sizeof(state->display));
    memset(state->memory, 0, sizeof(state->memory));

    uint8_t font_data[80] =  {
        0xF0, 0x90, 0x90, 0x90, 0xF0, // 0
        0x20, 0x60, 0x20, 0x20, 0x70, // 1
        0xF0, 0x10, 0xF0, 0x80, 0xF0, // 2
        0xF0, 0x10, 0xF0, 0x10, 0xF0, // 3
        0x90, 0x90, 0xF0, 0x10, 0x10, // 4
        0xF0, 0x80, 0xF0, 0x10, 0xF0, // 5
        0xF0, 0x80, 0xF0, 0x90, 0xF0, // 6
        0xF0, 0x10, 0x20, 0x40, 0x40, // 7
        0xF0, 0x90, 0xF0, 0x90, 0xF0, // 8
        0xF0, 0x90, 0xF0, 0x10, 0xF0, // 9
        0xF0, 0x90, 0xF0, 0x90, 0x90, // A
        0xE0, 0x90, 0xE0, 0x90, 0xE0, // B
        0xF0, 0x80, 0x80, 0x80, 0xF0, // C
        0xE0, 0x90, 0x90, 0x90, 0xE0, // D
        0xF0, 0x80, 0xF0, 0x80, 0xF0, // E
        0xF0, 0x80, 0xF0, 0x80, 0x80, // F
    };

    for(int i = 0; i < 80; i++){
        state->memory[i] = font_data[i];
    }
}

uint8_t map_key_to_chip8(char key){
    // Typical mapping looks like this:

    // 1 2 3 4   ->  1 2 3 C
    // Q W E R   ->  4 5 6 D
    // A S D F   ->  7 8 9 E
    // Z X C V   ->  A 0 B F

    // boilerplate    
}

void print_keypad_state(bool* keypad){
    // boilerplate
}

void state_update_keypad(state_ *state, char key, bool pressed){
    // boilerplate
}
